<app-user></app-user>
<!-- TABS -->
<div class="container" data-sr="" data-sr-duration="1000" data-sr-distance="20"
    style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
    <ul class="mpl-user-navigation mpl-carousel" data-gap="0" data-slides="auto">
        <div
            class="swiper-container swiper-container-initialized swiper-container-horizontal swiper-container-pointer-events">
            <div class="swiper-wrapper" id="swiper-wrapper-6b310a6364dd3e127" aria-live="polite">
                <div class="swiper-slide swiper-slide-next" role="group" aria-label="2 / 6">
                    <li>
                        <a routerLink="/profile"> Profile </a>
                    </li>
                </div>
                <div class="swiper-slide" role="group" aria-label="4 / 6">
                    <li>
                        <a routerLink="/settings"> Settings </a>
                    </li>
                </div>
                <div class="swiper-slide" role="group" aria-label="5 / 6">
                    <li class="active">
                        <a routerLink="/inventory"> Inventory </a>
                    </li>
                </div>
                <div class="swiper-slide" role="group" aria-label="5 / 6">
                    <li>
                        <a routerLink="/orders"> Orders </a>
                    </li>
                </div>
                <!-- <div class="swiper-slide" role="group" aria-label="3 / 6">
                    <li>
                        <a href="user-messages.html"> Messages<span class="badge badge-brand">8</span>
                        </a>
                    </li>
                </div> -->
            </div><span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span>
        </div>

    </ul>
</div>
<!-- CONTENT -->
<div class="mpl-box-md">
    <div class="container">
        <div class="row hgap-lg vgap-lg">
            <div class="col mpl-content mpl-isotope">

                <!-- INVENTORY -->
                <h2>Inventory</h2>

                <!-- NG FOR -->
                <form action="" [formGroup]="this.updateProductPriceFrom" (ngSubmit)="onUpdateKeyPriceSubmit()">

                    <table
                        class="table mpl-table-responsive-sm cyberpress-table cyberpress-team-players table-hover mb-0 mpl-table-product"
                        style="width: max-content;">
                        <thead style="text-align-last: center;">
                            <tr>
                                <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                            class="name">ICON</span></button></th>
                                <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                            class="name">PRODUCT</span></button></th>
                                <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                            class="name">PRICE €</span></button></th>
                                <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                            class="name">DISCOUNT %</span></button></th>
                                <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                            class="name">KEYS</span></button></th>
                                <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                            class="name">ACTION</span></button></th>
                                <!-- <th></th> -->
                            </tr>
                        </thead>

                        <tbody *ngFor="let product of myProducts" style="text-align-last: center;">
                            <ng-container *ngIf="getNumberOfListedKeys(product) > 0" ;>

                                <!-- <input [hidden]="true" formControlName="productId" type="number" value="{{this.product.id}}" id="product_id" class="form-control"> -->

                                <tr>
                                    <td class="cyberpress-table-item-image cyberpress-table-item-small"
                                        style="width: auto;">
                                        <a href="esports-single-player.html" routerLink="/product-view/{{this.product.productDetails.id}}">
                                            <img src="{{this.imagePath}}{{this.product.productDetails.title}}.png"
                                                alt="" class="cyberpress-team-players-thumb"
                                                style="height: unset; width: 70px;">
                                        </a>
                                    </td>
                                    <td class="cyberpress-table-item-game">
                                        <a routerLink="/product-view/{{this.product.productDetails.id}}">{{this.product.productDetails.title}}</a>
                                        <div class="cyberpress-player-team-dates">
                                            {{this.product.productDetails.publisher}}
                                        </div>
                                    </td>

                                    <td class="mpl-table-price" data-title="Price">
                                        <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                                            style="width:100px; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                                            <!-- <input formControlName="lastName" type="text" placeholder="{{this.user.lastName}}"
                                        class="form-control" style="padding:unset;"> -->
                                            <input formControlName="productKeyPrice"
                                                [class.is-invalid]="getKeyPrice?.invalid && getKeyPrice?.touched"
                                                class="form-control" type="number" min="0"
                                                placeholder="{{this.product.pricePerKey}}">
                                            <span class="form-control-bg"></span>
                                        </div>
                                        <!-- <span class="mpl-price" *ngIf="this.discountApplied;else oldFullPrice">€{{this.product.pricePerKey}}
                                    <span>€114.99</span></span>
                                <ng-template #oldFullPrice>
                                    <span #this.discount>€114.99</span>
                                </ng-template> -->
                                    </td>
                                    <td>
                                        <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                                            style="width:100px; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                                            <input formControlName="productKeyDiscount"
                                                [class.is-invalid]="getKeyDiscount?.invalid && getKeyDiscount?.touched"
                                                class="form-control" type="number" min="0" id="product_discount"
                                                name="product_discount" value=""
                                                placeholder="{{this.product.discountPercent}}"><span
                                                class="form-control-bg"></span>
                                        </div>
                                    </td>
                                    <td>{{this.product.productKeys.length}}</td>
                                    <td>
                                        <div class="col-12">
                                            <a class="btn btn-block btn-primary"
                                                (click)="showProductEdit(this.product.productDetails.title)">EDIT</a>
                                            <br>
                                            <button type="submit" class="btn btn-block btn-success"
                                                (click)="setProductId(this.product.id)"
                                                [disabled]="(updateProductPriceFrom.valid)?false:true">UPDATE</button>
                                            <!-- btn-secondary btn-primary-->
                                        </div>
                                    </td>
                                </tr>
                                <!-- KEYS DISPLAY ROW -->
                                <ng-container
                                    *ngIf="this.editProduct == this.product.productDetails.title && this.openProductEdit">
                                    <!-- <thead> -->
                                    <tr>
                                        <!-- <th></th>
                                <th></th>
                                <th></th> -->
                                        <th>
                                            <button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                    class="name">No.</span></button>
                                        </th>
                                        <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                    class="name">Key Code</span></button></th>
                                        <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                    class="name">Action</span></button></th>


                                        <!-- <th></th> -->
                                    </tr>
                                    <!-- </thead> -->
                                    <tr *ngFor="let productKey of product.productKeys; let idx = index">
                                        <!-- <td></td>
                                <td></td>
                                <td></td> -->
                                        <td>
                                            {{idx+1}}
                                        </td>
                                        <td class="cyberpress-table-item-game">
                                            <a>Activation Key</a>
                                            <div class="cyberpress-player-team-dates">{{this.productKey.activationKey}}
                                            </div>
                                        </td>
                                        <td>
                                            <div class="col-12">
                                                <button type="button" class="btn btn-block btn-md"
                                                    (click)="onRemoveKey(this.productKey.activationKey, this.product.productDetails.title)">REMOVE</button>
                                                <!-- btn-secondary btn-primary-->
                                            </div>
                                        </td>
                                    </tr>
                                </ng-container>
                            </ng-container>
                        </tbody>

                    </table>
                </form>

                <!-- NG FOR END -->
                <br>

                <div class="col-12">
                    <button class="btn btn-md" (click)="showNewKeyForm()">Add New Key</button>
                </div>

                <!-- <form action="">
                    <div class="col-12 col-md-6 col-lg-4" data-sr-item="product_title"
                        style="padding-right: 10px; width:30%; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <label for="product_title">Product Title:</label><input class="form-control" type="text"
                            id="product_title" name="product_title" placeholder="Product" list="products"><span
                            class="form-control-bg"></span>
                        <datalist id="products">
                            <option *ngFor="let productTitle of productDetails" value="{{productTitle.title}}"></option>
                        </datalist>
                    </div>
                    <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                        style="padding-right: 10px; width:12%; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <label for="product_price">Price:</label><input class="form-control" type="text"
                            id="product_price" name="product_price" placeholder="€"><span
                            class="form-control-bg"></span>
                    </div>
                    <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                        style="padding-right: 10px; width:30%; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <label for="activation_key">Key:</label><input class="form-control" type="text"
                            id="activation_key" name="activation_key" placeholder="Activation Code"><span
                            class="form-control-bg"></span>
                    </div>
                </form> -->

                <br>
                <div *ngIf="this.keySubmitSuccess == 'failed'" class="alert alert-fail" role="alert">
                    <strong>Failed!</strong> Key could not be added to your inventory.
                </div>
                <div *ngIf="this.keySubmitSuccess == 'success'" class="alert alert-success" role="alert">
                    <strong>Success!</strong> Key has been succesfully added to your inventory.
                </div>


                <div [hidden]="true">
                    <datalist id="products">
                        <option *ngFor="let productTitle of productDetails" value="{{productTitle.title}}"></option>
                    </datalist>
                </div>

                <div *ngIf="this.openNewKeyForm">
                    <form action="" [formGroup]="addNewKeyForm" (ngSubmit)="onAddNewKeySubmit()">
                        <table
                            class="table mpl-table-responsive-sm cyberpress-table cyberpress-team-players table-hover mb-0 mpl-table-product">
                            <thead style="text-align-last: center;">
                                <tr>
                                    <!-- <th></th> -->
                                    <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                class="name">PRODUCT</span></button></th>
                                    <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                class="name">PRICE €</span></button></th>
                                    <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                class="name">DISCOUNT %</span></button></th>
                                    <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                class="name">KEY CODE</span></button></th>
                                    <th><button type="button" class="btn btn-secondary dropdown-toggle"><span
                                                class="name">ACTION</span></button></th>
                                </tr>
                            </thead>
                            <tbody style="text-align-last: center;">
                                <tr>
                                    <!-- <td class="cyberpress-table-item-image cyberpress-table-item-small"></td> -->
                                    <td class="cyberpress-table-item-game">
                                        <!-- <a href="/game-route/keys">Overwatch 2</a> -->
                                        <!-- <div class="cyberpress-player-team-dates">Blizzard Entertainment</div> -->
                                        <div class="col-12 col-md-6 col-lg-4" data-sr-item="product_title"
                                            style="width:150px; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                                            <input formControlName="productTitle"
                                                [class.is-invalid]="getProductTitle?.invalid && getProductTitle?.touched"
                                                class="form-control" type="text" id="product_title" name="product_title"
                                                placeholder="Product Title" list="products">
                                            <span class="form-control-bg"></span>
                                            <datalist id="products">
                                                <option *ngFor="let productTitle of productDetails"
                                                    value="{{productTitle.title}}"></option>
                                            </datalist>
                                        </div>
                                    </td>
                                    <td class="mpl-table-price" data-title="Price">
                                        <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                                            style="width:100px; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                                            <input formControlName="productKeyPrice"
                                                [class.is-invalid]="getProductKeyPrice?.invalid && getProductKeyPrice?.touched"
                                                class="form-control" type="number" min="0" id="product_price"
                                                name="product_price" placeholder="€"><span
                                                class="form-control-bg"></span>
                                        </div>

                                    </td>
                                    <td class="mpl-table-price" data-title="PriceDiscount">
                                        <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                                            style="width:100px; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                                            <input formControlName="productKeyDiscount"
                                                [class.is-invalid]="getProductKeyDiscount?.invalid && getProductKeyDiscount?.touched"
                                                class="form-control" type="number" min="0" id="product_price_discount"
                                                name="product_price_discount" placeholder="%"><span
                                                class="form-control-bg"></span>
                                        </div>

                                    </td>
                                    <td>
                                        <div class="col-12 col-md-6 col-lg-4" data-sr-item="checkout"
                                            style="width:150px; display: inline-block; visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1s cubic-bezier(0.5, 0, 0, 1) 0s;">
                                            <input formControlName="activationKey"
                                                [class.is-invalid]="getActivationKey?.invalid && getActivationKey?.touched"
                                                class="form-control" type="text" id="activation_key"
                                                name="activation_key" placeholder="Activation Code"><span
                                                class="form-control-bg"></span>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="col-12">
                                            <button type="submit" [disabled]="(addNewKeyForm.valid)?false:true"
                                                class="btn btn-md">SAVE</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div *ngIf="getProductTitle?.invalid && getProductTitle?.touched || 
                        getProductKeyPrice?.invalid && getProductKeyPrice?.touched ||
                        getActivationKey?.invalid && getActivationKey?.touched || 
                        getProductKeyDiscount?.invalid && getProductKeyDiscount?.touched">
                            <small class="text-danger"> Form fields contain invalid data </small>
                        </div>
                    </form>
                </div>
                <!-- NEW UP -->
            </div>
            <!-- <div class="col-auto mpl-sidebar" data-sr="widget" data-sr-duration="1200" data-sr-distance="20">
                <div class="mpl-widget mpl-widget-search">
                    <div data-sr-item="widget"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <form action="#">
                            <input type="text" class="form-control" name="s" placeholder="Enter a search term">
                            <div class="form-control-bg"></div>
                        </form>
                    </div>
                </div>

                <div class="mpl-widget mpl-widget-categories">
                    <h4 class="mpl-widget-title" data-sr-item="widget"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        Categories</h4>
                    <ul class="list-unstyled" data-sr-item="widget"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <li><a href="#">All</a></li>
                        <li><a href="#">Audio</a></li>
                        <li><a href="#">Photo</a></li>
                        <li><a href="#">Video</a></li>
                        <li><a href="#">Controllers</a></li>
                    </ul>
                </div>
                <div class="mpl-widget mpl-widget-products">
                    <h4 class="mpl-widget-title" data-sr-item="widget"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        Popular Products</h4>
                    <ul class="list-unstyled" data-sr-item="widget"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <li>
                            <a href="shop-product.html" class="mpl-product-widget mpl-product-item">
                                <span class="mpl-product-image">
                                    <span class="mpl-image">
                                        <img src="assets/images/dark/product-260x200.jpg" alt="">
                                    </span>
                                </span>
                                <span class="mpl-product-content">
                                    <span class="mpl-product-title text-truncate h5">Gamepad MPL</span>
                                    <span class="mpl-price"> €120.00 </span>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="shop-product.html" class="mpl-product-widget mpl-product-item">
                                <span class="mpl-product-image">
                                    <span class="mpl-image">
                                        <img src="assets/images/dark/product-2-260x200.jpg" alt="">
                                    </span>
                                </span>
                                <span class="mpl-product-content">
                                    <span class="mpl-product-title text-truncate h5">Headphones MPL</span>
                                    <span class="mpl-price"> €84.99 <span>€114.99</span>
                                    </span>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="shop-product.html" class="mpl-product-widget mpl-product-item">
                                <span class="mpl-product-image">
                                    <span class="mpl-image">
                                        <img src="assets/images/dark/product-3-260x200.jpg" alt="">
                                    </span>
                                </span>
                                <span class="mpl-product-content">
                                    <span class="mpl-product-title text-truncate h5">Headphones MPS</span>
                                    <span class="mpl-price"> €74.99 </span>
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="mpl-widget mpl-widget-instagram">
                    <h4 class="mpl-widget-title" data-sr-item="widget"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        Instagram</h4>
                    <div class="mpl-instagram row hgap-xs vgap-xs" data-sr-item="widget" data-instagram-quality="md"
                        data-instagram-column-class="col-6 col-sm-4" data-instagram-count="6"
                        style="visibility: visible; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transition: opacity 1.2s cubic-bezier(0.5, 0, 0, 1) 0s, transform 1.2s cubic-bezier(0.5, 0, 0, 1) 0s;">
                        <div class="col-12">Failed to fetch data</div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>
</div>